<Window x:Class="HelseVestIKT_Dashboard.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wfi="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
        xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
        Title="Helse Vest IKT" Height="800" Width="1500"
        Loaded="MainWindow_Loaded">
	<Window.Resources>
		<!-- Stil for verktøylinje-knapper -->
		<Style x:Key="ToolBarButtonStyle" TargetType="Button">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="Padding" Value="5"/>
			<Setter Property="Margin" Value="2"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#E0E0E0"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Background" Value="#C0C0C0"/>
				</Trigger>
			</Style.Triggers>
		</Style>
		<!-- Gjennomsiktig knappestil for spillbokser -->
		<Style x:Key="TransparentButtonStyle" TargetType="Button">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderBrush" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Padding" Value="0"/>
		</Style>
	</Window.Resources>

	<DockPanel>
		<!-- Toppverktøylinje implementert med et Grid -->
		<Grid DockPanel.Dock="Top" Background="SkyBlue" Height="80">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="2*"/>
				<ColumnDefinition Width="2*"/>
				<ColumnDefinition Width="2*"/>
			</Grid.ColumnDefinitions>

			<!-- Venstre gruppe: VR-utstyrsstatus -->
			<StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,15,0,0">
				<!-- Headset-ikon -->
				<StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="20,0">
					<Border x:Name="HeadsetStatusBorder" BorderThickness="2" CornerRadius="4" Width="50">
						<Border.Style>
							<Style TargetType="Border">
								<Setter Property="BorderBrush" Value="Green"/>
								<Style.Triggers>
									<DataTrigger Binding="{Binding VREquipmentStatus.IsHeadsetConnected}" Value="False">
										<Setter Property="BorderBrush" Value="Red"/>
									</DataTrigger>
								</Style.Triggers>
							</Style>
						</Border.Style>
						<Button x:Name="HeadsetButton" Style="{StaticResource ToolBarButtonStyle}" Click="HeadsetButton_Click">
							<Image Source="Bilder/vrheadset.png" Width="32" Height="32"/>
						</Button>
					</Border>
					<TextBlock Text="{Binding VREquipmentStatus.HeadsetBatteryPercentage, StringFormat={}{0:F0}%}"
                     HorizontalAlignment="Center" FontSize="12"/>
				</StackPanel>
				<!-- Venstre kontroller-ikon -->
				<StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="0,0,20,0">
					<Border x:Name="LeftControllerStatusBorder" BorderThickness="2" CornerRadius="4">
						<Border.Style>
							<Style TargetType="Border">
								<Setter Property="BorderBrush" Value="Green"/>
								<Style.Triggers>
									<DataTrigger Binding="{Binding VREquipmentStatus.IsLeftControllerConnected}" Value="False">
										<Setter Property="BorderBrush" Value="Red"/>
									</DataTrigger>
								</Style.Triggers>
							</Style>
						</Border.Style>
						<Button x:Name="LeftControllerButton" Style="{StaticResource ToolBarButtonStyle}" Click="LeftControllerButton_Click">
							<Image Source="/Bilder/vrkontrollere.png" Width="32" Height="32" Stretch="Uniform"/>
						</Button>
					</Border>
					<TextBlock Text="{Binding VREquipmentStatus.LeftControllerBatteryPercentage, StringFormat={}{0:F0}%}"
                     HorizontalAlignment="Center" FontSize="12"/>
				</StackPanel>
				<!-- Høyre kontroller-ikon -->
				<StackPanel Orientation="Vertical" HorizontalAlignment="Center">
					<Border x:Name="RightControllerStatusBorder" BorderThickness="2" CornerRadius="4">
						<Border.Style>
							<Style TargetType="Border">
								<Setter Property="BorderBrush" Value="Green"/>
								<Style.Triggers>
									<DataTrigger Binding="{Binding VREquipmentStatus.IsRightControllerConnected}" Value="False">
										<Setter Property="BorderBrush" Value="Red"/>
									</DataTrigger>
								</Style.Triggers>
							</Style>
						</Border.Style>
						<Button x:Name="RightControllerButton" Style="{StaticResource ToolBarButtonStyle}" Click="RightControllerButton_Click">
							<Image Source="/Bilder/vrkontrollere.png" Width="32" Height="32" Stretch="Uniform"/>
						</Button>
					</Border>
					<TextBlock Text="{Binding VREquipmentStatus.RightControllerBatteryPercentage, StringFormat={}{0:F0}%}"
                     HorizontalAlignment="Center" FontSize="12"/>
				</StackPanel>
			</StackPanel>

			<!-- Sentergruppe: Applikasjonstittel -->
			<TextBlock Grid.Column="1" Text="Helse Vest IKT"
                 FontSize="20" FontWeight="Bold" VerticalAlignment="Center"
                 HorizontalAlignment="Center" Margin="50,0,50,0"/>

			<!-- Høyre gruppe: Klokke, Volum, WiFi, Fullskjerm, Avslutt -->
			<StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="50,0,10,0">
				<TextBlock Text="{Binding CurrentTime}"
               VerticalAlignment="Center" FontSize="20" Margin="50,0,5,0" Width="Auto" Foreground="Black"
               HorizontalAlignment="Right" FontWeight="ExtraBold"/>
				<Grid>
					<!-- Høyttalerknapp og Volum-popup -->
					<Button x:Name="SpeakerButton" Style="{StaticResource ToolBarButtonStyle}"
                  MouseEnter="SpeakerButton_MouseEnter" MouseLeave="SpeakerButton_MouseLeave" BorderBrush="{x:Null}">
						<Image Source="/Bilder/speaker.png" Width="20" Height="20"/>
					</Button>
					<Popup x:Name="VolumePopup"
                 Placement="Custom"
                 CustomPopupPlacementCallback="VolumePopupPlacementCallback"
                 PlacementTarget="{Binding ElementName=SpeakerButton}"
                 AllowsTransparency="True" StaysOpen="False"
                 MouseEnter="VolumePopup_MouseEnter" MouseLeave="VolumePopup_MouseLeave">
						<Border Background="White" BorderBrush="Gray" BorderThickness="1" Padding="5">
							<StackPanel>
								<Slider x:Name="VolumeSlider" Width="100" Minimum="0" Maximum="100" Value="50"
                        ToolTip="Juster volum" ValueChanged="VolumeSlider_ValueChanged"/>
								<TextBlock x:Name="VolumeStatusTextBlock" Text="50%" HorizontalAlignment="Center" Margin="0,5,0,0"/>
							</StackPanel>
						</Border>
					</Popup>
				</Grid>
				<!-- WiFi-signalindikator -->
				<StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0,10,0">
					<Image x:Name="WifiSignalIcon" Width="24" Height="24" Margin="5"/>
					<TextBlock x:Name="WifiSignalTextBlock" Margin="5,0,0,0" VerticalAlignment="Center" FontSize="14"/>
				</StackPanel>
				<!-- Innstillingsknapp -->
				<Button Style="{StaticResource ToolBarButtonStyle}" Click="Settings_Click" Margin="20,0,20,0" BorderThickness="0">
					<Image Source="Bilder/settings.png" Width="24" Height="24"/>
				</Button>
				<!-- Fullskjerm-knapp -->
				<Button Style="{StaticResource ToolBarButtonStyle}" Click="FullScreenButton_Click" Margin="20,0,20,0" BorderThickness="0" FontSize="20">
					⛶
				</Button>
				<!-- Avslutt-knapp -->
				<Button Style="{StaticResource ToolBarButtonStyle}" Click="ExitButton_Click" Margin="20,0,20,0" BorderThickness="0">
					❌
				</Button>
			</StackPanel>
		</Grid>

		<!-- Ny verktøylinje for VR-funksjonsknapper -->
		<Grid DockPanel.Dock="Top" Background="SkyBlue" Height="60">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>
			<!-- Venstre side VR-knapper -->
			<StackPanel Grid.Column="0" Orientation="Horizontal" Margin="20,0,20,0" VerticalAlignment="Center" HorizontalAlignment="Center">
				<Button Content="Romkalibrering" Width="120" Margin="0,0,50,0" FontWeight="ExtraBold" Click="RomKalibrering"/>
				<Button Content="Høydekalibrering" Width="125" Margin="0,0,50,0" FontWeight="ExtraBold" Click="HøydeKalibrering"/>
				<Button Content="Midtstill" Width="100" Margin="0,0,50,0" FontWeight="ExtraBold" Click="MidstillView"/>
				<Button Content="Kalibrering" Width="120" Margin="0,0,50,0" FontWeight="ExtraBold" Click="VRSettingsButton_Click"/>
				<Button x:Name="ReturnButton" Width="100" FontWeight="ExtraBold" Click="ReturnButton_Click"
                Visibility="Collapsed" Margin="0,0,50,0" Content="Tilbake til spillbibliotek"/>
				<Button x:Name="ResetButtoN" Click="ResetButton_Click" Visibility="Visible" Width="100" Margin="5,0,50,0" 
						FontWeight="ExtraBlack" Content="Tilbakestill"/>
				<Button x:Name="PauseButton" Width="100" FontWeight="ExtraBold" Content="Nødstopp" Margin="0,0,50,0"/>
				<Button Content="Pause-knapp" Width="100" Margin="0,0,0,0" FontWeight="ExtraBold"/>
			</StackPanel>
		</Grid>

		<!-- Header-rad med Filter/Sorter, Tittel og Søkeboks -->
		<Grid DockPanel.Dock="Top" Height="40" Margin="0,10" x:Name="HeaderGrid">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto"/>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="Auto"/>
			</Grid.ColumnDefinitions>
			<Button x:Name="FilterButton" Content="Filter/Sorter" 
        FontStyle="Italic" Width="75" FontWeight="Bold" Margin="20,0,0,0"
        Click="FilterButton_Click"/>

			<TextBlock Grid.Column="1" Text="Alle spill" FontSize="24" FontWeight="Bold"
                 VerticalAlignment="Center" HorizontalAlignment="Center"/>
			<TextBox Grid.Column="2" Text="Søk etter spill..."
               x:Name="SearchBox"
               VerticalAlignment="Center" Margin="10,0,10,0" Height="24" Width="150"
               ToolTip="Search games"
               GotFocus="SearchBox_GotFocus"
               LostFocus="SearchBox_LostFocus"
               KeyDown="SearchBox_KeyDown"/>
		</Grid>

		<Grid x:Name="GameLibraryArea" HorizontalAlignment="Stretch" ClipToBounds="True">
			<!-- Spillbiblioteksområde -->
			<ScrollViewer x:Name="GameLibraryScrollViewer" Visibility="Visible"
                HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
				<ItemsControl x:Name="GamesItemsControl" ItemsSource="{Binding Games}"
                  HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
					<ItemsControl.ItemsPanel>
						<ItemsPanelTemplate>
							<WrapPanel HorizontalAlignment="Stretch"/>
						</ItemsPanelTemplate>
					</ItemsControl.ItemsPanel>
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Button Click="LaunchGameButton_Click" Style="{StaticResource TransparentButtonStyle}" Margin="10">
								<StackPanel Width="300" Height="300">
									<Border BorderThickness="2" Background="Transparent"
                      HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Height="250">
										<Image Source="{Binding GameImage}" Stretch="Uniform"
                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
									</Border>
									<TextBlock Text="{Binding Title}" HorizontalAlignment="Center" TextTrimming="CharacterEllipsis"
                         Margin="0,5,0,0" FontWeight="Bold" MaxWidth="180"/>
								</StackPanel>
							</Button>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>
			</ScrollViewer>

			<!-- VR-Live-visning plassert inne i samme grid -->
			<wfi:WindowsFormsHost x:Name="VRHost" Visibility="Collapsed" Width="800" Height="600"
                         HorizontalAlignment="Center" VerticalAlignment="Center"/>
		</Grid>

	</DockPanel>
</Window>