<Window x:Class="HelseVestIKT_Dashboard.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wfi="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
		 xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
		xmlns:vm="clr-namespace:HelseVestIKT_Dashboard.ViewModels;assembly=HelseVestIKT_Dashboard"
		xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
		xmlns:ei="http://schemas.microsoft.com/xaml/behaviors"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:conv="clr-namespace:HelseVestIKT_Dashboard.Converters" d:DataContext="{d:DesignInstance Type=vm:MainWindowViewModel}"
		xmlns:local="clr-namespace:HelseVestIKT_Dashboard.Converters"
		mc:Ignorable="d"
		Title="Helse Vest IKT" Height="1080" Width="1920"
	WindowState="Maximized"
		WindowStyle="None"
		ResizeMode="NoResize"
		Topmost="True"
		ShowInTaskbar="True">

	<!-- 1) Your Interaction.Triggers go here, as a direct child of Window -->
	<i:Interaction.Triggers>
		<i:EventTrigger EventName="Loaded">
			<ei:InvokeCommandAction 
				Command="{Binding InitializeCommand}"
				PassEventArgsToCommand="True"/>
		</i:EventTrigger>
		<i:EventTrigger EventName="KeyDown">
			<ei:InvokeCommandAction
        Command="{Binding WindowKeyDownCommand}"
        PassEventArgsToCommand="True" />
		</i:EventTrigger>
	</i:Interaction.Triggers>
	
	<Window.Resources>
		<conv:BoolToVisibilityConverter x:Key="BoolToVis"/>
		<local:ZeroToVisibilityConverter x:Key="ZeroToVisibility"/>
		<local:InverseBooleanToVisibilityConverter x:Key="InvBoolToVis"/>
		
		<FontFamily x:Key="SourceSansFont">Source Sans Pro</FontFamily>
		<Style x:Key="SquareRoundedButtonStyleAvsluttButton" TargetType="Button">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border"
                CornerRadius="8" 
							Background="{TemplateBinding Background}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}">
							<ContentPresenter HorizontalAlignment="Stretch"
                            VerticalAlignment="Center"
                            RecognizesAccessKey="True" Margin="10,0,10,0"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="MinHeight" Value="30"/>
			<Setter Property="Padding" Value="10,4"/>
			<Setter Property="Background" Value="#FF671F"/>
			<Setter Property="BorderBrush" Value="#003087"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Margin" Value="5"/>
			<Setter Property="Foreground" Value="#003087"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#EFEFEF"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Background" Value="#DDDDDD"/>
				</Trigger>
			</Style.Triggers>
		</Style>
		
		
		<!--Status bar Pauseknapp stil-->
		<Style x:Key="SquareRoundedButtonStylePauseButton" TargetType="Button">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border"
        CornerRadius="8" 
					Background="{TemplateBinding Background}"
        BorderBrush="{TemplateBinding BorderBrush}"
        BorderThickness="{TemplateBinding BorderThickness}">
							<ContentPresenter HorizontalAlignment="Stretch"
                    VerticalAlignment="Center"
                    RecognizesAccessKey="True" Margin="10,0,10,0"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="MinHeight" Value="30"/>
			<Setter Property="Padding" Value="10,4"/>
			<Setter Property="Background" Value="#FFC845"/>
			<Setter Property="BorderBrush" Value="#003087"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Margin" Value="5"/>
			<Setter Property="Foreground" Value="#003087"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#EFEFEF"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Background" Value="#DDDDDD"/>
				</Trigger>
			</Style.Triggers>
		</Style>

		<Style x:Key="SquareRoundedButtonStyle" TargetType="Button">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border"
        CornerRadius="8" 
					Background="{TemplateBinding Background}"
        BorderBrush="{TemplateBinding BorderBrush}"
        BorderThickness="{TemplateBinding BorderThickness}">
							<ContentPresenter HorizontalAlignment="Stretch"
                    VerticalAlignment="Center"
                    RecognizesAccessKey="True" Margin="10,0,10,0"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="MinHeight" Value="30"/>
			<Setter Property="Padding" Value="10,4"/>
			<Setter Property="Background" Value="White"/>
			<Setter Property="BorderBrush" Value="#003087"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Margin" Value="5"/>
			<Setter Property="Foreground" Value="#003087"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#EFEFEF"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Background" Value="#DDDDDD"/>
				</Trigger>
			</Style.Triggers>
		</Style>

		<Style x:Key="SquareRoundedButtonStyleNodstoppButton" TargetType="Button">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border"
        CornerRadius="8" 
					Background="{TemplateBinding Background}"
        BorderBrush="{TemplateBinding BorderBrush}"
        BorderThickness="{TemplateBinding BorderThickness}">
							<ContentPresenter HorizontalAlignment="Stretch"
                    VerticalAlignment="Center"
                    RecognizesAccessKey="True" Margin="10,0,10,0"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="MinHeight" Value="30"/>
			<Setter Property="Padding" Value="10,4"/>
			<Setter Property="Background" Value="#CB333B"/>
			<Setter Property="BorderBrush" Value="#003087"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Margin" Value="5"/>
			<Setter Property="Foreground" Value="#003087"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#EFEFEF"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Background" Value="#DDDDDD"/>
				</Trigger>
			</Style.Triggers>
		</Style>

		<Style x:Key="SquareRoundedButtonStyleKalibreringButton" TargetType="Button">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="border"
CornerRadius="8" 
			Background="{TemplateBinding Background}"
BorderBrush="{TemplateBinding BorderBrush}"
BorderThickness="{TemplateBinding BorderThickness}">
							<ContentPresenter HorizontalAlignment="Stretch"
            VerticalAlignment="Center"
            RecognizesAccessKey="True" Margin="10,0,10,0"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="MinHeight" Value="30"/>
			<Setter Property="Padding" Value="10,4"/>
			<Setter Property="Background" Value="White"/>
			<Setter Property="BorderBrush" Value="#003087"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="HorizontalContentAlignment" Value="Center"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Margin" Value="5"/>
			<Setter Property="Foreground" Value="#003087"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#EFEFEF"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Background" Value="#DDDDDD"/>
				</Trigger>
			</Style.Triggers>
		</Style>

		<Style x:Key="TilskuerButtonStyle" TargetType="Button" BasedOn="{StaticResource SquareRoundedButtonStyle}">
			<Setter Property="Background" Value="Transparent" />
		</Style>

		<!-- Transparent knapp for ItemsControl (brukes til spillkort), men fortsatt avrundet -->
		<Style x:Key="TransparentButtonStyleAvsluttButton" TargetType="Button" BasedOn="{StaticResource SquareRoundedButtonStyle}">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderBrush" Value="Transparent"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Padding" Value="0"/>
		</Style>

		<!-- Knapp for 'View Property' / CTA-knapper -->
		<Style x:Key="ViewPropertyButtonStyle" TargetType="Button" BasedOn="{StaticResource SquareRoundedButtonStyle}">
			<Setter Property="Background" Value="#007ACC"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="Bold"/>
			<Setter Property="Padding" Value="5,2"/>
			<Setter Property="Margin" Value="0,5,0,0"/>
			<Setter Property="BorderBrush" Value="#007ACC"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Cursor" Value="Hand"/>
			<Style.Triggers>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Background" Value="#005A99"/>
				</Trigger>
			</Style.Triggers>
		</Style>

		<!-- Stil for tekstboksen (Søk...) -->
		<Style TargetType="TextBox" x:Key="SearchBoxStyle">
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="Margin" Value="10"/>
			<Setter Property="VerticalAlignment" Value="Top"/>
			<Setter Property="Height" Value="35"/>
		</Style>

		<!-- Updated TextBlock style with a unique key -->
		<Style x:Key="SourceSansTextBlockStyle" TargetType="TextBlock">
			<Setter Property="FontFamily" Value="{StaticResource SourceSansFont}"/>
			<Setter Property="FontSize" Value="16"/>
			<Setter Property="Foreground" Value="#003087"/>
		</Style>

		<!-- Test Style for checkbox -->
		<Style TargetType="CheckBox">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="CheckBox">
						<StackPanel Orientation="Horizontal">
							<Border x:Name="border"
                    Width="24"
                    Height="24"
                    CornerRadius="6"
                    Background="White"
                    BorderThickness="2"
                    BorderBrush="Gray">
								<Border.Effect>
									<DropShadowEffect BlurRadius="5" ShadowDepth="2" Opacity="0.3"/>
								</Border.Effect>
								<Grid>
									<Rectangle x:Name="checkBackground"
                               Fill="White"
                               RadiusX="6" RadiusY="6"/>
									<Path x:Name="checkMark"
                          Data="M4,12 L10,18 L20,6"
                          Stroke="Black"
                          StrokeThickness="2"
                          Visibility="Collapsed"/>
								</Grid>
							</Border>
							<ContentPresenter Margin="8,0,0,0" VerticalAlignment="Center"/>
						</StackPanel>
						<ControlTemplate.Triggers>
							<!-- Når CheckBox er sjekket -->
							<Trigger Property="IsChecked" Value="True">
								<Setter TargetName="checkBackground" Property="Fill" Value="LightGray"/>
								<Setter TargetName="checkMark" Property="Visibility" Value="Visible"/>
							</Trigger>

							<!-- Når musen er over CheckBox -->
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="border" Property="Background" Value="#EFEFEF"/>
								<Setter TargetName="border" Property="BorderBrush" Value="#003087"/>
							</Trigger>

							<!-- Når CheckBox er deaktivert -->
							<Trigger Property="IsEnabled" Value="False">
								<Setter TargetName="border" Property="Opacity" Value="0.5"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- Base-stil for CheckBox med avrundede hjørner -->
		<Style x:Key="RoundedCheckBoxStyle" TargetType="CheckBox">
			<Setter Property="Margin" Value="5"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="CheckBox">
						<StackPanel Orientation="Horizontal">
							<Border x:Name="CheckBoxBorder" Width="30" Height="30"
                                    CornerRadius="4"
                                    Background="White"
                                    BorderBrush="Gray"
                                    BorderThickness="1"
                                    VerticalAlignment="Center">
								<Path x:Name="CheckMark"
                                      Data="M2,8 L6,12 L14,4"
                                      Stroke="Black"
                                      StrokeThickness="2"
                                      Visibility="Collapsed"
									  Margin="6"/>
							</Border>
							<ContentPresenter VerticalAlignment="Center" Margin="5,0,0,0"/>
						</StackPanel>
						<ControlTemplate.Triggers>
							<Trigger Property="IsChecked" Value="True">
								<Setter TargetName="CheckBoxBorder" Property="Background" Value="LightBlue"/>
								<Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="DarkGray"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- Stil for CheckBox som bruker SourceSansFont -->
		<Style x:Key="RoundedCheckBoxWithSourceSansFontStyle" TargetType="CheckBox" BasedOn="{StaticResource RoundedCheckBoxStyle}">
			<Setter Property="FontFamily" Value="{StaticResource SourceSansFont}"/>
			<Setter Property="Foreground" Value="#003087"/>
			<Setter Property="FontSize" Value="16"/>
		</Style>


		<!-- Stil for Knapp med + -->
		<Style x:Key="RoundedButtonStyle" TargetType="Button">
			<Setter Property="Margin" Value="5"/>
			<Setter Property="HorizontalAlignment" Value="Left"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border x:Name="ButtonBorder" Width="30" Height="30"
                        CornerRadius="4"
                        Background="White"
                        BorderBrush="Gray"
                        BorderThickness="2"
                        VerticalAlignment="Center">
							<ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsPressed" Value="True">
								<Setter TargetName="ButtonBorder" Property="Background" Value="LightBlue"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter TargetName="ButtonBorder" Property="BorderBrush" Value="DarkGray"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

	</Window.Resources>

	<Grid Background="#F6F6F6">
		<Grid.RowDefinitions>
			<!-- Rad 0: Toppmeny -->
			<RowDefinition Height="Auto"/>
			<!-- Spiller nå / Status / Knapper -->
			<RowDefinition Height="Auto"/>
			<!-- Rad 1: Innhold -->
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- TOPPMENY / HEADER -->
		<Border x:Name="ToolbarGrid" Grid.Row="0" Background="White" BorderThickness="0,0,0,1" BorderBrush="#DDD">
			<Border.Effect>
				<DropShadowEffect BlurRadius="4"
								  ShadowDepth="3"
								  Direction="270"
								  Color="Black"
								  Opacity="0.9"/>
			</Border.Effect>

			<Grid x:Name="HeaderGrid" Height="100">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="Auto"/>
				</Grid.ColumnDefinitions>

				<!-- Venstre del: pilleformet knapp for VR-kalibrering -->
				<StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0">

					<!-- VENSTRE SEKSJON: VR-headset og kontrollerstatus -->
					<StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0">

						<!-- Headset -->
						<StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="10">
							<!-- HEADSET -->
							<Border Width="60" Height="60" CornerRadius="25" BorderThickness="5">
								<Border.Style>
									<Style TargetType="Border">
										<Setter Property="BorderBrush" Value="Red"/>
										<Style.Triggers>
											<DataTrigger Binding="{Binding VREquipmentStatus.IsHeadsetConnected}" Value="True">
												<Setter Property="BorderBrush" Value="Green"/>
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</Border.Style>
								<Button Style="{StaticResource SquareRoundedButtonStyle}"
            Background="Transparent" BorderThickness="0"
            Width="50" Height="32">
									<Image Source="/Assets/Bilder/vr_headset.png" Width="32" Height="32"/>
								</Button>
							</Border>
							<TextBlock HorizontalAlignment="Center" FontSize="12" Margin="0,5">
								<TextBlock.Style>
									<Style TargetType="TextBlock">
										<Setter Property="Text"
                Value="{Binding VREquipmentStatus.HeadsetBatteryPercentage,
                                StringFormat={}{0:F0}%}"/>
										<Style.Triggers>
											<DataTrigger Binding="{Binding VREquipmentStatus.IsHeadsetConnected}" Value="False">
												<Setter Property="Text" Value="Ikke tilkoblet"/>
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</TextBlock.Style>
							</TextBlock>
						</StackPanel>

						<!-- LEFT CONTROLLER -->
						<StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="10">
							<Border Width="60" Height="60" CornerRadius="25" BorderThickness="5">
								<Border.Style>
									<Style TargetType="Border">
										<Setter Property="BorderBrush" Value="Red"/>
										<Style.Triggers>
											<DataTrigger Binding="{Binding VREquipmentStatus.IsLeftControllerConnected}" Value="True">
												<Setter Property="BorderBrush" Value="Green"/>
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</Border.Style>
								<Button Style="{StaticResource SquareRoundedButtonStyle}"
            Background="Transparent" BorderThickness="0"
            Width="50" Height="32">
									<Image Source="/Assets/Bilder/kontroller_venstre.png" Width="31" Height="31"/>
								</Button>
							</Border>
							<TextBlock HorizontalAlignment="Center" FontSize="12" Margin="0,5">
								<TextBlock.Style>
									<Style TargetType="TextBlock">
										<Setter Property="Text"
                Value="{Binding VREquipmentStatus.LeftControllerBatteryPercentage,
                                StringFormat={}{0:F0}%}"/>
										<Style.Triggers>
											<DataTrigger Binding="{Binding VREquipmentStatus.IsLeftControllerConnected}" Value="False">
												<Setter Property="Text" Value="Ikke tilkoblet"/>
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</TextBlock.Style>
							</TextBlock>
						</StackPanel>

						<!-- RIGHT CONTROLLER -->
						<StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="10">
							<Border Width="60" Height="60" CornerRadius="25" BorderThickness="5">
								<Border.Style>
									<Style TargetType="Border">
										<Setter Property="BorderBrush" Value="Red"/>
										<Style.Triggers>
											<DataTrigger Binding="{Binding VREquipmentStatus.IsRightControllerConnected}" Value="True">
												<Setter Property="BorderBrush" Value="Green"/>
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</Border.Style>
								<Button Style="{StaticResource SquareRoundedButtonStyle}"
            Background="Transparent" BorderThickness="0"
            Width="50" Height="32">
									<Image Source="/Assets/Bilder/kontroller.png" Width="31" Height="31"/>
								</Button>
							</Border>
							<TextBlock HorizontalAlignment="Center" FontSize="12" Margin="0,5">
								<TextBlock.Style>
									<Style TargetType="TextBlock">
										<Setter Property="Text"
                Value="{Binding VREquipmentStatus.RightControllerBatteryPercentage,
                                StringFormat={}{0:F0}%}"/>
										<Style.Triggers>
											<DataTrigger Binding="{Binding VREquipmentStatus.IsRightControllerConnected}" Value="False">
												<Setter Property="Text" Value="Ikke tilkoblet"/>
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</TextBlock.Style>
							</TextBlock>
						</StackPanel>

					</StackPanel>
				</StackPanel>

				<!--Kalibreringsknapp-->
				<StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center" Panel.ZIndex="200">
					
					<!-- Knapp for å vise/hide sidemeny -->
					<Button x:Name="VisKnapp" Style="{StaticResource SquareRoundedButtonStyle}" Height="45" Margin="10,0,0,15" Visibility="Collapsed" Command="{Binding ShowSideMenuCommand}">
						<StackPanel>
							<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" Text="Vis sidemeny"/>
						</StackPanel>
					</Button>

					<!--Knapp for å justere høydekalibrering-->
					<StackPanel x:Name="Hoydekalibrering_Slider" Width="175" Margin="10,0,0,15" Visibility="Collapsed">
						<!-- Overskrift -->
						<TextBlock Style="{DynamicResource SourceSansTextBlockStyle}"
    Text="Høydekalibrering (m)" 
    FontWeight="Bold" 
    FontSize="14" 
    Margin="0,0,0,8"/>

						<!-- Stor, tydelig slider -->
						<Slider
x:Name="HeightSlider"
Width="150"
Height="32"
Minimum="-0.3"
Maximum="0.3"
TickFrequency="0.05"
SmallChange="0.01"
LargeChange="0.05"
Ticks="1.2,1.5,1.8,2.0,2.2,2.5"
TickPlacement="BottomRight"
IsSnapToTickEnabled="False"
AutoToolTipPlacement="TopLeft"
AutoToolTipPrecision="2"
Value="{Binding EyeHeightSetting, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
Margin="0,0,0,8">
							<!-- Gjør thumbs litt større via et enkelt ressurs‐override -->
							<Slider.Resources>
								<Style TargetType="Thumb">
									<Setter Property="Width" Value="20"/>
									<Setter Property="Height" Value="20"/>
								</Style>
							</Slider.Resources>
						</Slider>

						<!-- Viser nummerverdien i fet font -->
						<TextBlock  Style="{DynamicResource SourceSansTextBlockStyle}"
Text="{Binding EyeHeightSetting, StringFormat={}{0:F2} m}" 
HorizontalAlignment="Center"
FontSize="12"
FontWeight="SemiBold"/>
					</StackPanel>
				</StackPanel>


				<!-- Midtstilt logo/tekst -->
				<StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center">
					<Grid Width="60" Height="60" Margin="10,0">
						<!-- 3 rader og 3 kolonner -->
						<Grid.RowDefinitions>
							<RowDefinition/>
							<RowDefinition/>
							<RowDefinition/>
						</Grid.RowDefinitions>
						<Grid.ColumnDefinitions>
							<ColumnDefinition/>
							<ColumnDefinition/>
							<ColumnDefinition/>
						</Grid.ColumnDefinitions>

						<!-- Lyse blå sirkel i midten -->
						<Ellipse Grid.Row="1" Grid.Column="1"
             Fill="#6CACE4"
             Width="13" Height="13"
             HorizontalAlignment="Center"
             VerticalAlignment="Center"
			Margin="3"
			/>

						<!-- Lysere blå sirkel øverst -->
						<Ellipse Grid.Row="0" Grid.Column="1"
             Fill="#6CACE4"
             Width="13" Height="13"
             HorizontalAlignment="Center"
             VerticalAlignment="Center"
			Margin="3"/>

						<!-- Lysere blå sirkel til venstre -->
						<Ellipse Grid.Row="1" Grid.Column="0" 
             Fill="#003087"
             Width="13" Height="13"
             HorizontalAlignment="Center"
             VerticalAlignment="Center" 
								 Margin="3"/>

						<!-- Lysere blå sirkel til høyre -->
						<Ellipse Grid.Row="1" Grid.Column="2"
             Fill="#6CACE4"
             Width="13" Height="13"
             HorizontalAlignment="Center"
             VerticalAlignment="Center"
								 Margin="3"/>

						<!-- Lysere blå sirkel nederst -->
						<Ellipse Grid.Row="2" Grid.Column="1"
             Fill="#6CACE4"
             Width="13" Height="13"
             HorizontalAlignment="Center"
             VerticalAlignment="Center"
								 Margin="3"/>
					</Grid>
					<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" Text="HELSE" 
                      FontSize="24"
                     VerticalAlignment="Center" 
                     Margin="0,0"/>
					<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" Text="VEST" 
					  FontSize="24"
					FontWeight="Bold"
					 VerticalAlignment="Center" 
					 Margin="10,0"/>
				</StackPanel>

				<!-- Høyre del: wifi, volum, klokke, avslutt-knapp (alle pilleformet) -->
				<StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0">

					<StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="0,5,0,0">
						<!-- 1) Høyttaler‐ikon -->
						<Image Source="/Assets/Bilder/speaker_popup.png"
         Width="32" Height="32"
         VerticalAlignment="Center" Margin="0,-7,5,0"/>

						<!-- 2) Volum-slider -->
						<Slider Minimum="0" Maximum="100"
          Value="{Binding VolumePercent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
          TickFrequency="5"
          IsSnapToTickEnabled="True"
          Width="120"/>

						<!-- 3) Prosent-tekst -->
						<TextBlock Width="40"
             Text="{Binding VolumeText}"
             TextAlignment="Right"
             VerticalAlignment="Center"
             Margin="5,0,0,0"
             FontSize="14"/>
					</StackPanel>





					<!-- Klokke -->
					<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" Text="{Binding CurrentTime}" VerticalAlignment="Center" FontSize="24" FontWeight="SemiBold" Margin="10,0"/>

					

					<!-- Innstillingsknapp -->
					<Button Style="{StaticResource SquareRoundedButtonStyle}" BorderThickness="0" Command="{Binding OpenSettingsCommand}">
						<StackPanel>
							<Image Source="/Assets/Bilder/setting.png" Width="32" Height="32"/>
						</StackPanel>
					</Button>

					<!-- Wifi signal-->
						<StackPanel Orientation="Horizontal" Margin="0,0,10,0">
							<Image x:Name="WifiSignalIcon" Width="32" Height="32" Margin="10,0,10,0" Source="/Assets/Bilder/wifi_3_bar.png"/>
						</StackPanel>
	
					<!-- Fullskjerm knapp -->
					<Button x:Name="FullScreenButton" Style="{StaticResource SquareRoundedButtonStyle}" Width="200" Height="50" Command="{Binding EnterFullscreenCommand}">
						<StackPanel Orientation="Horizontal">
							<TextBlock Text="VR-tilskuervindu" Style="{StaticResource SourceSansTextBlockStyle}" Margin="5,5,15,5" TextAlignment="Left"/>
							<Image Source="/Assets/Bilder/VR-tilskuervindu.png" Width="32" Height="32" HorizontalAlignment="Right"/>
						</StackPanel>
					</Button>
					<!-- Avslutt-knapp -->
					<Button x:Name="ExitButton" Style="{StaticResource SquareRoundedButtonStyle}" Width="190" Height="50" Command="{Binding ExitApplicationCommand}">
						<StackPanel Orientation="Horizontal">
							<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" Text="Avslutt program" TextAlignment="Left" Margin="5,5,15,5"/>
							<Image Source="/Assets/Bilder/exit_knapp.png" Width="32" Height="32" HorizontalAlignment="Right" />
						</StackPanel>
					</Button>
				</StackPanel>
			</Grid>
		</Border>

		<!-- Status, Spiller nå, knapper -->

		<Grid x:Name="StatusBar" Grid.Row="1" Height="60" Background="White" Visibility="Visible" >
			<Grid.Effect>
				<DropShadowEffect BlurRadius="6"
								  ShadowDepth="2"
								  Direction="270"
								  Color="Black"
								  Opacity="0.9"/>

			</Grid.Effect>

			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto"/> <!--Spiller nå-->
				<ColumnDefinition Width="Auto"/> <!--Spiller nå - tekst -->
				<ColumnDefinition Width="Auto"/> <!--Status-->
				<ColumnDefinition Width="Auto"/> <!--Status tekst-->
				<ColumnDefinition Width="*"/> <!--Seperator-->
				<ColumnDefinition Width="Auto"/> <!--Kalibrering-->
				<ColumnDefinition Width="*"/> <!--Seperator-->
				<ColumnDefinition Width="Auto"/> <!--Hjem, Avslutt, Nødstopp-->
			</Grid.ColumnDefinitions>

			<!--Spiller nå-->
			<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" FontSize="18" FontWeight="Bold" Grid.Column="0" Text="Spiller nå:" VerticalAlignment="Center" Margin="10,0"/>
			<TextBox Grid.Column="1" x:Name="CurrentGameTextBlock" Background="#E6A700" IsHitTestVisible="false" FontSize="18" Text="{Binding CurrentPlayer}" VerticalAlignment="Center" Width="Auto"/>

			<Rectangle x:Name="SeperatorVenstre_Kalibrering" Grid.Column="4" Width="2" Height="45" Fill="#007ACC" Margin="6,0" Visibility="Collapsed"/>

			<!--Knapper (Pause, Avslutt og Nødstopp -->
			<StackPanel Grid.Column="5" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5,0,0,0">
				<StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Height="75">
					<Button Command="{Binding RoomSetupCommand}"
        Style="{StaticResource SquareRoundedButtonStyle}" Height="50"  Margin="0,0,20,17">
						<StackPanel Orientation="Horizontal">
							<TextBlock Style="{StaticResource SourceSansTextBlockStyle}"
							Text="Romkalibrering" Margin="0,7,2,0"/>
							<Image Source="/Assets/Bilder/RoomSetup.png" Height="32" Width="32" HorizontalAlignment="Right"/>
						</StackPanel>
						
					</Button>


					<Button Command="{Binding HeightCalibrationCommand}" Style="{StaticResource SquareRoundedButtonStyle}" Height="50"  Margin="0,0,20,17">
						<StackPanel Orientation="Horizontal">
							<TextBlock Text="Høydekalibrering" Style="{StaticResource SourceSansTextBlockStyle}" Margin="0,7,0,0" />
							<Image Source="/Assets/Bilder/Height.png" Height="32" Width="32" HorizontalAlignment="Right"/>
							</StackPanel>
					</Button>

					<Button Command="{Binding RecenterSeatedCommand}" Style="{StaticResource SquareRoundedButtonStyle}" Height="50"  Margin="0,0,20,17">
						<StackPanel Orientation="Horizontal">
							<TextBlock Text="Midtstill sittende" Style="{StaticResource SourceSansTextBlockStyle}" Margin="0,7,0,0"/>
							<Image Source="/Assets/Bilder/Sitting.png" Height="32" Width="32" HorizontalAlignment="Right"/>
						</StackPanel>
					</Button>

					<Button Command="{Binding RecenterStandingCommand}" Style="{StaticResource SquareRoundedButtonStyle}" Height="50"  Margin="0,0,0,17">
						<StackPanel Orientation="Horizontal">
							<TextBlock Text="Midtstill stående" Style="{StaticResource SourceSansTextBlockStyle}" Margin="0,5" />
							<Image Source="/Assets/Bilder/Standing.png" Height="32" Width="32" HorizontalAlignment="Right"/> 
						</StackPanel>
					</Button>
				</StackPanel>

			</StackPanel>

			<Rectangle x:Name="SeperatorHoyre_Kalibrering" Grid.Column="6" Width="2" Height="45" Fill="#007ACC" Margin="6,0" Visibility="Collapsed"/>

			<StackPanel Grid.Column="7" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,15,0">
				<!-- Return-knapp for spillvisning (skjules initialt) -->
				<Button x:Name="ReturnButton"  Command="{Binding ReturnHomeCommand}"
				Style="{StaticResource SquareRoundedButtonStyle}"
				HorizontalAlignment="Right" VerticalAlignment="Center" 
				Margin="5" Visibility="{Binding IsSpectating, Converter={StaticResource BoolToVis}}" Height="50">
					<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" Height="Auto" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Hjem"/>
				</Button>
				<Button Style="{StaticResource SquareRoundedButtonStylePauseButton}" Command="{Binding PauseCommand}" x:Name="PauseKnapp" Width="Auto" Height="50">
					<StackPanel Orientation="Horizontal">
						<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" VerticalAlignment="Center" Text="Pause" Margin="0,0,10,0"/>
						<Image Source="/Assets/Bilder/pause_knapp.png" Height="32" Width="32" HorizontalAlignment="Right"/>
					</StackPanel>
				</Button>

				<Button Style="{StaticResource SquareRoundedButtonStyleAvsluttButton}" Width="Auto" Command="{Binding QuitGameCommand}">
					<StackPanel Orientation="Horizontal">
						<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" VerticalAlignment="Center" Text="Avslutt" Margin="0,0,10,0"/>
						<Image Source="/Assets/Bilder/exit_knapp.png" Height="32" Width="32" HorizontalAlignment="Right"/>
					</StackPanel>
				</Button>

				<Button Style="{StaticResource SquareRoundedButtonStyleNodstoppButton}" x:Name="NodStoppKnapp" Width="115" Command="{Binding EmergencyStopCommand}">
					<StackPanel Orientation="Horizontal">
						<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" VerticalAlignment="Center" Text="Nødstopp" Margin="0,0,0,0"/>
						<Image Source="/Assets/Bilder/nodstopp_knapp.png" Height="32" Width="32"/>
					</StackPanel>
				</Button>

			</StackPanel>

		</Grid>

		<!-- HOVEDINNHOLD -->
		<Grid Grid.Row="2" x:Name="MainContentGrid">
			<Grid.ColumnDefinitions>
				<!-- Sidemeny: Bredden settes til 250 når den er synlig -->
				<ColumnDefinition x:Name="SideMenyColumn" Width="225"/>
				<!-- Hovedinnholdet -->
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>

			<!-- SIDEMENY -->
			<Border x:Name="SideMenu" Grid.Column="0" Background="White" BorderThickness="0,0,0,0" BorderBrush="#DDD">
				<Border.Effect>
					<DropShadowEffect BlurRadius="3" ShadowDepth="3" Direction="0" Color="Black" Opacity="0.9"/>
				</Border.Effect>
				<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Padding="10" PanningMode="VerticalFirst" PanningRatio="1.0" PanningDeceleration="0.00005" IsManipulationEnabled="True">
					<StackPanel Orientation="Vertical">
						<TextBlock Style="{DynamicResource SourceSansTextBlockStyle}" Text="Søk etter spill" FontWeight="Bold" Margin="10,5,0,0"/>
						<TextBox
    x:Name="SearchBox"
    Style="{StaticResource SearchBoxStyle}"
    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
    Foreground="Gray"
    />


						<TextBlock Style="{DynamicResource SourceSansTextBlockStyle}" Text="Filtrer etter:" FontWeight="Bold" Margin="10,5,0,0"/>

						<Separator Margin="10,10,10,10"/>
						<TextBlock
  Style="{DynamicResource SourceSansTextBlockStyle}"
  Text="Kategorier"
  FontWeight="Bold"
  Margin="10,5,0,0" />
						<ItemsControl
  ItemsSource="{Binding GenreFilters}"
  Margin="10,5,0,0">
							<ItemsControl.ItemTemplate>
								<DataTemplate>
									<CheckBox
        Content="{Binding DisplayName}"
        IsChecked="{Binding IsChecked,Mode=TwoWay}"
        Style="{StaticResource RoundedCheckBoxWithSourceSansFontStyle}"
        Margin="0,5,0,0"/>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>

						<Separator Margin="10,10,10,10"/>

						<!-- Type-filtre -->
						<TextBlock
  Style="{DynamicResource SourceSansTextBlockStyle}"
  Text="Type"
  FontWeight="Bold"
  Margin="10,15,0,0" />
						<ItemsControl
  ItemsSource="{Binding TypeFilters}"
  Margin="10,5,0,0">
							<ItemsControl.ItemTemplate>
								<DataTemplate>
									<CheckBox
        Content="{Binding DisplayName}"
        IsChecked="{Binding IsChecked,Mode=TwoWay}"
        Style="{StaticResource RoundedCheckBoxWithSourceSansFontStyle}"
        Margin="0,5,0,0"/>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
						<Separator x:Name="UPPER" Margin="10,10,10,10"/>

						<!-- 1) Knapp for å starte ny/rename -->
						<Button Content="+ Legg til kategori"
        Command="{Binding BeginAddCategoryCommand}"
        Style="{StaticResource RoundedButtonStyle}"
        Margin="10,5" />

						<!-- 2) Redigerings‐panel – vises kun når IsEditingCategory == true -->
						<StackPanel Orientation="Horizontal" Margin="10,5">
							<StackPanel.Style>
								<Style TargetType="StackPanel">
									<Setter Property="Visibility" Value="Collapsed"/>
									<Style.Triggers>
										<DataTrigger Binding="{Binding IsEditingCategory}" Value="True">
											<Setter Property="Visibility" Value="Visible"/>
										</DataTrigger>
									</Style.Triggers>
								</Style>
							</StackPanel.Style>

							<!-- a) Input for navnet -->
							<TextBox Width="150"
           Text="{Binding NewCategoryName, UpdateSourceTrigger=PropertyChanged}"
           Margin="0,5,0,0"/>

							<!-- b) OK / Avbryt -->
							<Button Content="OK"
          Command="{Binding CommitCategoryCommand}"
          Margin="8,0,0,0"/>
							<Button Content="Avbryt"
          Command="{Binding CancelCategoryCommand}"
          Margin="4,0,0,0"/>
						</StackPanel>

						<!-- 3) Liste over dynamiske kategorier -->
						<ItemsControl ItemsSource="{Binding CategoryFilters}"
              Margin="10,5,0,0">
							<ItemsControl.ItemTemplate>
								<DataTemplate>
									<StackPanel Orientation="Horizontal">
										<CheckBox Content="{Binding Group.GroupName}"
                  IsChecked="{Binding IsChecked,Mode=TwoWay}"
                  Style="{StaticResource RoundedCheckBoxWithSourceSansFontStyle}"
                  Margin="0,5,0,0"/>
										<Button Content="⋮"
                Command="{Binding DataContext.BeginRenameCategoryCommand,
                          RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                CommandParameter="{Binding}"
                Style="{StaticResource TransparentButtonStyleAvsluttButton}"
                Margin="5,5,0,0"/>
										<Button Content="🗑"
                Command="{Binding DataContext.DeleteCategoryCommand,
                          RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                CommandParameter="{Binding}"
                Style="{StaticResource TransparentButtonStyleAvsluttButton}"
                Margin="5,5,0,0"/>
									</StackPanel>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>

						<Separator x:Name="LOWER" Margin="10,10,10,10"/>
					<Button Content="Skjul" Style="{DynamicResource SquareRoundedButtonStyle}"
        HorizontalAlignment="Center" VerticalAlignment="Center" Command="{Binding HideSideMenuCommand}"/>
				</StackPanel>
				</ScrollViewer>
			</Border>

			<ItemsControl ItemsSource="{Binding ValgtKategori.Games}">
				<ItemsControl.ItemTemplate>
					<DataTemplate>
						<TextBlock Text="{Binding Title}"/>
					</DataTemplate>
				</ItemsControl.ItemTemplate>
			</ItemsControl>

			<!-- Spillvisning (dynamisk) -->
			<Grid x:Name="GameLibraryArea" Grid.Column="1" HorizontalAlignment="Stretch" ClipToBounds="True">
				<Grid.Effect>
					<DropShadowEffect BlurRadius="6"
									  ShadowDepth="5"
									  Direction="270"
									  Color="Black"
									  Opacity="0.9"/>
				</Grid.Effect>
				
				<ScrollViewer x:Name="GameLibraryScrollViewer" Visibility="Visible"
                      HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                      HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto" 
					  PanningMode="VerticalFirst" IsManipulationEnabled="True">
					<i:Interaction.Triggers>
						<i:EventTrigger EventName="PreviewTouchDown">
							<i:InvokeCommandAction
        Command="{Binding GameLibraryTouchDownCommand}"
        CommandParameter="{Binding}"/>
						</i:EventTrigger>
						<i:EventTrigger EventName="PreviewTouchMove">
							<i:InvokeCommandAction
        Command="{Binding GameLibraryTouchMoveCommand}"
        CommandParameter="{Binding}"/>
						</i:EventTrigger>
						<i:EventTrigger EventName="PreviewTouchUp">
							<i:InvokeCommandAction
        Command="{Binding GameLibraryTouchUpCommand}"
        CommandParameter="{Binding}"/>
						</i:EventTrigger>
					</i:Interaction.Triggers>

					<ItemsControl x:Name="gamesItemsControl" ItemsSource="{Binding Games}" HorizontalContentAlignment="Stretch">
						<ItemsControl.ItemsPanel>
							<ItemsPanelTemplate>
								<WrapPanel HorizontalAlignment="Stretch"/>
							</ItemsPanelTemplate>
						</ItemsControl.ItemsPanel>
						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<!-- Bruker den nye SquareRoundedButtonStyle her -->
								<Button Command="{Binding DataContext.LaunchGameCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" Style="{StaticResource SquareRoundedButtonStyle}" Margin="10">
									<StackPanel Width="250" Height="310">
										<Border BorderThickness="2" Background="Transparent"
                  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Height="250">
											<Image Source="{Binding GameImage}" Stretch="Uniform"
                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
										</Border>
										<TextBlock Style="{StaticResource SourceSansTextBlockStyle}" Text="{Binding Title}" HorizontalAlignment="Center" 
                     TextWrapping="Wrap" TextAlignment="Center" Margin="0,5,0,0" 
                     FontWeight="Bold" MaxWidth="180"/>
									</StackPanel>
								</Button>
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</ScrollViewer>
				</Grid>
			<WindowsFormsHost x:Name="VRHost"
                  Grid.Column="0" Grid.ColumnSpan="2"
                  HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                  Padding="0" Margin="0"
                  Visibility="{Binding IsSpectating, Converter={StaticResource BoolToVis}}">

				<i:Interaction.Triggers>
					<i:EventTrigger EventName="SizeChanged">
						<ei:InvokeCommandAction
        Command="{Binding VrHostResizedCommand}"
        PassEventArgsToCommand="True"/>
					</i:EventTrigger>
				</i:Interaction.Triggers>

				<wf:Panel x:Name="VRPanel"/>
			</WindowsFormsHost>
		</Grid>
	</Grid>
</Window>
